---
title: "AIvsHuman art analysis, Linear mixed models (Painting Type), study 1"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Below we have an analysis of AIvsHuman art perceptions. This script specifically serves to determine the role of painting type via linear mixed models. As such, for each DV, we assess main effects of label ('Mancheck') and main effects of painting type. Then, for each DV, we assess an interaction between the two that may qualify main effects.

```{r, echo=FALSE, include=FALSE}
library(lsmeans)
library(afex)
library(reshape2)
library(tidyverse)
library(ggplot2)
library(rstatix)
library(lme4)
library(moments)
```

# Data cleaning
## Load data
```{r}
#load raw
data <- read.csv('./AI_data_excel.csv')
#exclude first three Ps for unfinished data
df <- data[-c(1:3),]
#take out 'R_1Dp2fpr6MajEWsB' for bad data
df1 <- df[-c(which(df$ResponseId=='R_1Dp2fpr6MajEWsB')),]
df1 <- df1[1:197]
```

## exclude mismatched trials
```{r}
dfclean <- df1
#Mancheck30 wasn't properly labeled for condition (1 and 2 switched), needs to be switched

for (i in 1:nrow(dfclean)){
  #put 1s to 0
  if(dfclean[i, 'Mancheck_30'] == "1"){
    dfclean[i, 'Mancheck_30'] <- 0
  }
  #put 2s to 1s
  if(dfclean[i, 'Mancheck_30'] == "2"){
    dfclean[i, 'Mancheck_30'] <- 1
  }
  #put 0s (prev 1s) to 2s
  if(dfclean[i, 'Mancheck_30'] == 0){
    dfclean[i, 'Mancheck_30'] <- 2
  }
}

c<-0
for (i in 1:nrow(dfclean)){
  for (j in 1:30){
    if ( isTRUE(dfclean[i, paste0("Image",j, "_Condition")] != dfclean[i, paste0("Mancheck_", j)] )) {
      dfclean[i, paste0("A", j, "_1")] <- NA
      dfclean[i, paste0("A", j, "_2")] <- NA
      dfclean[i, paste0("A", j, "_3")] <- NA
      dfclean[i, paste0("A", j, "_4")] <- NA
      c <- c+1
    }
  }
}
print(c)
```

```{r, warning=FALSE, messaage=FALSE}
#reorganize data structure into appropriate long
df_new <- dfclean[-c(2:47)]

new.data <- data.frame(matrix(NA, nrow = 0, ncol = 7))
colnames(new.data) <- c("ID", "OrderNum", "ManCheck", "R1", "R2", "R3", "R4")
for (imagenum in 1:30){
  mancheck_col <- paste0("Mancheck_", imagenum)
  R1_col <- paste0("A", imagenum, "_1")
  R2_col <- paste0("A", imagenum, "_2")
  R3_col <- paste0("A", imagenum, "_3")
  R4_col <- paste0("A", imagenum, "_4")
  col_list <- c("ResponseId", mancheck_col, R1_col, R2_col, R3_col, R4_col)
  image_data <- dplyr::select(df_new, all_of(col_list))
  image_data['ImageNum'] <- imagenum
  image_data <- rename(image_data, 'Mancheck' = mancheck_col)
  image_data <- rename(image_data, 'R1' = R1_col)
  image_data <- rename(image_data, 'R2' = R2_col)
  image_data <- rename(image_data, 'R3' = R3_col)
  image_data <- rename(image_data, 'R4' = R4_col)
  #alternative option:
  #colnames(image_data) <- c("Response_ID", "OrderNum", "ManCheck", "R1", "R2", "R3", "R4") 
  new.data <- rbind(new.data, image_data)
}

#make everything numerics
for (j in 2:6){
    new.data[,j] <- as.numeric(new.data[,j])
}

#insert painting type code by image number (see Stimuli)
abstract <- c(2,4,6,8,9,11,14,15,17,20,21,23,24,28,29)
rep <- c(1,3,5,7,10,12,13,16,18,19,22,25,26,27,30)

new.data['paintType'] <- 1
for (i in 1:nrow(new.data)){
  if (new.data[i,'ImageNum'] %in% abstract){
    new.data[i,'paintType'] <- 'A'
  }
    else{
      new.data[i,'paintType'] <- 'R'
    }
}

new.data$Mancheck <- factor(new.data$Mancheck)
new.data$paintType <- factor(new.data$paintType)
new.data$ImageNum <- factor(new.data$ImageNum)

```

# Linear mixed models, with interactions
## Like
```{r}
#main effect
R1artmain <- lmer(R1 ~ Mancheck + 
                      paintType + (1 | ResponseId) + (1 | ImageNum), REML=FALSE, data = new.data)
summary(R1artmain)
#sig main effect of AI vs Human, sig main effect of abstract vs rep

#interaction
R1artinter <- lmer(R1 ~ Mancheck + 
                      paintType + Mancheck*paintType + (1 | ResponseId) + (1 | ImageNum), REML=FALSE, data = new.data)

summary(R1artinter)
#sig of interaction between the two
```


## Beauty
```{r}
#main effect
R2artmain <- lmer(R2 ~ Mancheck + 
                      paintType + (1 | ResponseId) + (1 | ImageNum), REML=FALSE, data = new.data)
summary(R2artmain)
#sig main effect of AI vs Human, sig main effect of abstract vs rep

#interaction
R2artinter <- lmer(R2 ~ Mancheck + 
                      paintType + Mancheck*paintType + (1 | ResponseId) + (1 | ImageNum), REML=FALSE, data = new.data)

summary(R2artinter)
#no sig of interaction between the two
```


## Profound
```{r}
#main effect
R3artmain <- lmer(R3 ~ Mancheck + 
                      paintType + (1 | ResponseId) + (1 | ImageNum), REML=FALSE, data = new.data)
summary(R3artmain)
#sig main effect of AI vs Human, sig main effect of abstract vs rep

#interaction
R3artinter <- lmer(R3 ~ Mancheck + 
                      paintType + Mancheck*paintType + (1 | ResponseId) + (1 | ImageNum),REML=FALSE, data = new.data)

summary(R3artinter)
#sig of interaction between the two
```


## Worth
```{r}
#main effect
R4artmain <- lmer(R4 ~ Mancheck + 
                      paintType + (1 | ResponseId) + (1 | ImageNum), REML=FALSE, data = new.data)
summary(R4artmain)
#sig main effect of AI vs Human, sig main effect of abstract vs rep

#interaction
R4artinter <- lmer(R4 ~ Mancheck + 
                      paintType + Mancheck*paintType + (1 | ResponseId) + (1 | ImageNum), REML=FALSE, data = new.data)

summary(R4artinter)
#no sig of interaction between the two
```




